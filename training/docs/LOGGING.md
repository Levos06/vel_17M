# Logging and Monitoring

–í—Å–µ –ª–æ–≥–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è**!

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
transformer/
‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îú‚îÄ‚îÄ training_metrics.csv    # –ú–µ—Ç—Ä–∏–∫–∏ (loss, lr, tokens/sec)
‚îÇ   ‚îú‚îÄ‚îÄ training.log            # –ü–æ–ª–Ω—ã–π –ª–æ–≥ –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ training_plots.png      # –ì—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ loss_curve.png          # –ì—Ä–∞—Ñ–∏–∫ loss
‚îú‚îÄ‚îÄ checkpoints/
‚îÇ   ‚îú‚îÄ‚îÄ step_XXX.pt            # 5 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ final_model.pt         # –§–∏–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å
‚îî‚îÄ‚îÄ ...
```

## üìä –ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

### 1. CSV —Ñ–∞–π–ª —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ (`logs/training_metrics.csv`)

```csv
step,loss,lr,tokens_per_sec,eta_hours,elapsed_hours
100,8.2341,0.00030000,2567.34,8.52,0.06
200,7.1234,0.00030000,2589.12,8.48,0.13
...
```

**–°—Ç–æ–ª–±—Ü—ã**:
- `step` - –Ω–æ–º–µ—Ä —à–∞–≥–∞
- `loss` - –∑–Ω–∞—á–µ–Ω–∏–µ loss
- `lr` - learning rate
- `tokens_per_sec` - —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è
- `eta_hours` - –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è
- `elapsed_hours` - –ø—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è

### 2. –¢–µ–∫—Å—Ç–æ–≤—ã–π –ª–æ–≥ (`logs/training.log`)

–ü–æ–ª–Ω–∞—è –∫–æ–ø–∏—è –≤—Å–µ–≥–æ, —á—Ç–æ –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å:
```
======================================================================
TRAINING START
======================================================================
Step    100 | Loss 8.2341 | LR 3.00e-04 | Tokens/s   2567 | ETA 8.5h
Step    200 | Loss 7.1234 | LR 3.00e-04 | Tokens/s   2589 | ETA 8.5h
...
```

## üìà –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ì—Ä–∞—Ñ–∏–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è

### –í—Ä—É—á–Ω—É—é –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç

```bash
python plot_metrics.py
```

–ò–ª–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:
```bash
python plot_metrics.py logs/training_metrics.csv
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç

–°–æ–∑–¥–∞—é—Ç—Å—è 2 —Ñ–∞–π–ª–∞:
1. **`logs/training_plots.png`** - 4 –≥—Ä–∞—Ñ–∏–∫–∞ (loss, lr, throughput, time)
2. **`logs/loss_curve.png`** - —Ç–æ–ª—å–∫–æ loss (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞)

## üìä –ü—Ä–∏–º–µ—Ä –≥—Ä–∞—Ñ–∏–∫–æ–≤

**training_plots.png** —Å–æ–¥–µ—Ä–∂–∏—Ç:
- Training Loss (–≤–µ—Ä—Ö–Ω–∏–π –ª–µ–≤—ã–π)
- Learning Rate Schedule (–≤–µ—Ä—Ö–Ω–∏–π –ø—Ä–∞–≤—ã–π)  
- Training Throughput (–Ω–∏–∂–Ω–∏–π –ª–µ–≤—ã–π)
- Elapsed Time (–Ω–∏–∂–Ω–∏–π –ø—Ä–∞–≤—ã–π)

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 20 —Å—Ç—Ä–æ–∫ –ª–æ–≥–∞
```bash
tail -20 logs/training.log
```

### –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
```bash
tail -f logs/training.log
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â—É—é loss
```bash
tail -1 logs/training_metrics.csv
```

### –ê–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫ –≤ Python
```python
import pandas as pd

df = pd.read_csv('logs/training_metrics.csv')
print(f"Current loss: {df['loss'].iloc[-1]:.4f}")
print(f"Average throughput: {df['tokens_per_sec'].mean():.0f}")
print(f"Training time: {df['elapsed_hours'].iloc[-1]:.2f} hours")
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ–±—É—á–µ–Ω–∏—è, —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è:
- `logs/training_metrics.csv` - CSV —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
- `logs/training.log` - —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ª–æ–≥

–í—Å–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏! üöÄ
